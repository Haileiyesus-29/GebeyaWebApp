/* eslint-disable react/prop-types */
import { useState, useEffect } from 'react'
import { storage } from '../../firebase'
import { getDownloadURL, ref } from 'firebase/storage'

function Image({ src, alt, className }) {
   const [imageUrl, setImageUrl] = useState('')
   const [loading, setLoading] = useState(false)

   useEffect(() => {
      const imageRef = ref(storage, `products/${src}`)

      const fetchImageLink = async () => {
         try {
            setLoading(true)
            const url = await getDownloadURL(imageRef)
            setImageUrl(url)
         } catch (err) {
            setImageUrl(
               'data:image/png;base64,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'
            )
         } finally {
            setLoading(false)
         }
      }
      fetchImageLink()
   }, [src])
   if (loading)
      return (
         <div className='w-full h-full animate-pulse bg-gradient-to-r from-gray-200 via-gray-300 to-gray-200'></div>
      )
   return <img src={imageUrl} alt={alt} className={className} />
}

export default Image
